window.S=function(a){"use strict";function b(a){a.def=new c.Deferred,a.def.wrap(a),a.deferredContext=a.def.getContext()}var c={};console.info("Initializing structural-core"),c.components={},c.views={};var d={},e={},f={},g={};c.defineComponent=function(a,e,f){d[a]=e,c.components[a]=function(){var e=d[a].apply(this,arguments);return c.config.provideDefaultDeferredContext&&!f&&b(e),c.views[a]&&(console.log("setting view "+a),e.view=c.views[a]()),e.init&&e.init(),e}},c.defineComponent2=function(a,e,f){d[a]=e,c.components[a]=function(e,g){var h=new d[a](e,g);return c.config.provideDefaultDeferredContext&&!f&&b(h),c.views[a]&&(h.view=c.views[a]()),h}},c.defineMethodOn=function(a,b,c){e[a]||(e[a]={}),e[a][b]=c},c.defineStandaloneMethod=function(a,b,c){f[name]||(f[name]={}),f[name].requirements=a,f[name].optionalRequirements=b,f[name][methodName]=c},c.setMetaData=function(a,b){g[a]=b},c.setDefaultView=function(a,b){c.views[a]=b},c.addMethod=function(a,b,c){e[a]||(e[a]={}),e[a][b]=c},c.getComponentMethods=function(a){return e[a]},c.config={provideDefaultDeferredContext:!0,viewClass:"structural_view",specialStrings:{nullString:"__null"}};var h=0;return c.nextId=function(){return"sid_"+h++},c.map=function(){var a={},b={},c=function(c,d){if(!c.sid)throw new Error("S.map() requires sid property. Use S.nextId().");return"undefined"==typeof d?(a[c.sid]||(a[c.sid]={}),a[c.sid]):(a[c.sid]=d,void(b[c.sid]=c))};return c.clear=function(){a={},b={}},c.delete=function(b){if(!b.sid)throw new Error("S.map() requires sid property. Use S.nextId().");delete a[b.sid]},c.has=function(b){if(!b.sid)throw new Error("S.map() requires sid property. Use S.nextId().");return"undefined"!=typeof a[b.sid]},c.forEach=function(c,d){d||(d={});for(var e in a)c.call(d,[b[e],a[e]])},c},c.wait=function(a,b){setTimeout(a,b)},c.EventEmitter=function(){function a(){this.registeredEvents={}}return a.prototype.on=function(a,b){this.registeredEvents[a]||(this.registeredEvents[a]=[]),this.registeredEvents[a].push(b)},a.prototype.fire=function(a,b){if(this.registeredEvents[a])for(var c=0;c<this.registeredEvents[a].length;c++)this.registeredEvents[a][c].call(b,b)},a}(),c.ee=function(){var a={};return a.registeredEvents={},a.on=function(b,c){"undefined"==typeof a.registeredEvents[b]&&(a.registeredEvents[b]=[]),a.registeredEvents[b].push(c)},a.fire=function(b,c){if("undefined"!=typeof a.registeredEvents[b])for(var d=0;d<a.registeredEvents[b].length;d++)a.registeredEvents[b][d].call(c,c)},a},c.Component=function(){function a(a,b){a&&(this.state=a),b&&(this.view=b)}return a.prototype=Object.create(c.EventEmitter.prototype),Object.defineProperty(a.prototype,"view",{get:function(){return this._view},set:function(a){this._view=a,a.component=this,a.init()}}),Object.defineProperty(a.prototype,"state",{get:function(){return this._state},set:function(a){this._state=a}}),a.prototype.getSync=function(){return this.live},a.prototype.getAsync=function(){return this.view.live},a.prototype.getMethods=function(){return c.getComponentMethods(this.name)},a}(),c.View=function(a){function b(){this.live={},this._speed=0,this._config={},this.$element=a("<div></div>").addClass(c.config.viewClass)}return b.prototype=Object.create(c.EventEmitter.prototype),b.prototype.init=function(){},b.prototype.render=function(){},b.prototype.scaleTo=function(a){this.$element.width(a.width),this.$element.height(a.height)},Object.defineProperty(b.prototype,"config",{get:function(){return this._config},set:function(b){a.extend(this._config,b)}}),b.prototype.speed=function(){},b}(jQuery),c.simpleWrappable=function(){var a={live:{},async:{}};return a.noCopy=!0,a.getSync=function(){return a.live},a.getAsync=function(){return a.async},a},c.defineComponent("std",function(){var a=c.simpleWrappable(),b={},d=[],e=[];return a.live.errors=function(){return d},a.live.throwError=function(a){d.push(a)},a.live.warnings=function(){return e},a.live.warn=function(a){console.log("warning: "+a),e.push(a)},a.live.set=function(a,c){b[a]=c},a.live.get=function(a){return b[a]},a.live.is=function(a,c){return b[a]===c},a.live.log=function(a){console.log(a)},a.live.flog=null,a.live.falert=null,a.async.falert=function(a,b){window.alert(a),b()},a.async.flog=function(a,b){console.log(a),b()},a},!0),c.Deferred=function(){function b(){this.context=function(a,b){return"undefined"==typeof b?this.context.get(a):void this.context.set(a,b)},this.fns=[],this.last=0,this.open=!0,this.executing=!1,this.stepTime=50,a.extend(this,new c.EventEmitter),this.on("push",function(){open&&!this.executing&&(console.log("mode is open; executing..."),this.exec())})}return b.prototype.close=function(){this.open=!1,this.executing=!1},b.prototype.open=function(){this.open=!0,this.fns.length>0&&this.exec()},Object.defineProperty(b.prototype,"length",{get:function(){return console.log("length get"),this.fns.length}}),Object.defineProperty(b.prototype,"completion",{get:function(){return this.last/this.length}}),b.prototype.exec=function(){function a(){return b>=d.fns.length?void(d.executing=!1):void(d.executing&&(d.last++,d.fns[b++].call({},function(){console.log("doing next..."),c.wait(a,d.stepTime)})))}this.executing=!0;var b=this.last,d=this;a()},b.prototype.getContext=function(){return console.log("returning Deferred.context"),this.context},b.prototype.add=function(a,b){b.bind(this.context),this.context[a]=b},b.prototype.wrap=function(a){this.include(c.components.std()),Array.isArray(a)?a.forEach(this.include):this.include(a)},b.prototype.include=function(a){var b,c=this;if("undefined"==typeof a.getSync||"undefined"==typeof a.getAsync)return console.warn("cannot wrap "+a+". no getSync() and/or getAsync() not found.");a.noCopy||(console.info("Deferred copying "+a),b=new a.constructor(a.state)),console.groupCollapsed("Wrapping methods of '%s'",a.alias||a);for(var d in a.getSync())console.log("Wrapping '%s'",d),this.context[d]=function(b,d){var e=function(){var e,f=Array.prototype.slice.call(arguments);null!==a.getSync()[b]&&(e=a.noCopy?a.live[b].apply({},f):d.getSync()[b].apply({},f));var g;return a.getAsync().hasOwnProperty(b)&&null!==a.getSync()[b]?g=function(c){a.getSync()[b].apply(a.getSync(),f),a.getAsync()[b].apply(a.getAsync(),f.concat(c))}:null!==a.getSync()[b]?g=function(c){a.getSync()[b].apply(a.getSync(),f),c()}:a.getAsync().hasOwnProperty(b)?g=function(c){a.getAsync()[b].apply(a.getAsync(),f.concat(c))}:(console.log("method "+b.toString()+" was declared as async only (null), but no corresponding view method was found."),g=!1),g&&c.fns.push(g),c.fire("push",c),null!==e?e:void 0};return e}(d,b);if(console.groupEnd(),a.getMethods){var e=a.getMethods();console.groupCollapsed("Adding defined methods of '%s'",a.alias||a);for(var f in e)console.log("Adding "+f),this.add(f,e[f])}console.groupEnd()},b}(),c.component=function(a,b,d){c.defineComponent(a,b,!1),d&&c.setMetaData(a,d)},c.method=function(a,b,d){c.defineMethodOn(a,b,d)},c.view=function(a,b){c.setDefaultView(a,b)},c}(jQuery),function(a){function b(c){var d=new a.Component,e=[];return c&&(d.array=c),d.alias="array",d.copy=function(){return b(d.array.slice(0))},d.live.focus=null,d.live.range=null,d.live.clearfocus=null,d.live.clearrange=null,d.live.leftTo=null,d.live.getLength=function(){return d.array.length},d.live.flag=function(a){e[a]=!0},d.live.isFlagged=function(a){return!!e[a]},d.live.setItem=function(a,b){d.array[a]=b},d.live.getItem=function(a){return d.array[a]},d.live.push=function(a){console.log("pushing "+a+" in array.js"),d.array.push(a)},d.getMethods=function(){return a.getComponentMethods("array")},d}a.component("array",b,{name:"Array",desc:"A standard array."})}(window.S),S.view("array",function(a){function b(a){a.click(c),a.dblclick(d)}function c(){console.log("handleTdClick"),console.log("setting focus to "+$(this).data("index")),r.live.focus($(this).data("index"))}function d(){$(this).hasClass("flagged")?$(this).removeClass("flagged"):$(this).addClass("flagged")}function e(a,c){var d=$("<td>"+a+"</td>"),e=$("<th>"+c+"</th>"),f=d.add(e).css({opacity:0,width:p});return d.addClass("array-cell"),e.addClass("array-index"),f.data("index",c),l.append(d),m.append(e),s=s.add(d),t=t.add(e),b(d,e),f}function f(a){h(a,r.config.pageTime,o-1)}function g(a){h(a,r.config.stepTime,n)}function h(a,b,c){var d="+=";a||(d="-=");var e={};e.scrollLeft=d+c,j.animate(e,b)}function i(a,b,c){j.animate({scrollLeft:a},b,function(){"undefined"!=typeof c&&c()})}var j,k,l,m,n,o,p,q,r=new S.View,s=$(),t=$(),u=0;return r.init=function(){r.config={hiddenDelimiter:",",numElements:5,pageTime:300,stepTime:50,scrollTime:500,maxScrollTime:1e3},r.config=a,r.leftBound=0,r.rightBound=r.config.numElements-1},r.config=function(a){$.extend(r.config,a),r.leftBound=0,r.rightBound=r.config.numElements-1},r.render=function(){j&&j.remove(),s=$(),t=$(),j=$('<div class="array"></div>'),k=$("<table></table>"),l=$("<tr></tr>").addClass("array-top"),m=$("<tr></tr>").addClass("array-bottom"),j.append(k),k.append(l).append(m),k.css({height:q}),l.css({fontSize:Math.round(.25*k.height())});for(var a=0;a<r.component.array.length;a++){var c=$("<td>"+r.component.array[a]+'<span style="font-size: 0;">'+r.config.hiddenDelimiter+"</span></td>"),d=$("<th>"+a+"</th>");c.data("index",a),d.data("index",a),c.width(p),d.width(p),c.addClass("array-cell"),d.addClass("array-index"),l.append(c),m.append(d),s=s.add(c),t=t.add(d)}return n=p+u,o=r.config.numElements*n+u,j.css("width",o),b(s),r.$element.append(j),r.$element},r.scaleTo=function(a){o=a.width,q=a.height,r.$element.css("width",a.width),r.$element.css("height",a.height),p=Math.floor(o/r.config.numElements)-u,r.render()},r.live.focus=function(a,b){if(!(0>a||a>r.component.array.length-1)){s.removeClass("focus"),t.removeClass("focus"),s.eq(a).addClass("focus"),t.eq(a).addClass("focus");var c=a-Math.floor(r.config.numElements/2);r.live.leftTo(c,b)}},r.live.clearfocus=function(a){s.removeClass("focus"),t.removeClass("focus"),a()},r.live.flag=function(a,b){s.eq(a).addClass("flagged"),b&&b()},r.live.range=function(a,b,c,d){var e=s.slice(a,b+1),f="range"+c;e.addClass(function(a){var b=e.eq(a).attr("class"),c=f+" "+b;e.eq(a).attr("class",c)}),d()},r.live.clearrange=function(a,b){s.removeClass("range"+a),b()},r.live.setItem=function(a,b,c){r.live.focus(a,function(){S.wait(function(){s.eq(a).addClass("array-remove"),S.wait(function(){s.eq(a).text(b),s.eq(a).removeClass("array-remove"),c()},300)},200)})},r.live.push=function(a,b){console.log("pushing "+a+" in array.view.js"),console.log("view.component.array = "+r.component.array),console.log("view.component.array.length = "+r.component.array.length),console.log("view.component.array.length - 1 = "+r.component.array.length-1);var c=e(a,r.component.array.length-1);r.live.leftTo(r.component.array.length-1,function(){c.animate({opacity:1},200,function(){b()})})},r.live.leftTo=function(a,b){if(a=parseInt(a,10),!isNaN(a)){0>=a&&(a=0),a>=r.component.array.length-1&&(a=r.component.array.length-1);var c=Math.min(Math.abs(a-r.leftBound)*r.config.stepTime,r.config.maxScrollTime);0==a?(r.leftBound=0,r.rightBound=r.config.numElements-1):a>r.component.array.length-r.config.numElements?(r.leftBound=r.component.array.length-r.config.numElements,r.rightBound=r.component.array.length-1):(r.leftBound=a,r.rightBound=a+r.config.numElements-1),i(a*n,c,b)}},r.live.rightTo=function(a){if(a=parseInt(a,10),!isNan(a)){0>=a&&(a=0),a>=r.component.array.length-1&&(a=r.component.array.length-1);var b=Math.min(Math.abs(a-r.leftBound)*r.config.stepTime,r.config.maxScrollTime);a<=r.config.numElements-1?(r.leftBound=0,r.rightBound=r.config.numElements-1):a==r.component.array.length-1?(r.leftBound=r.component.array.length-r.config.numElements,r.rightBound=r.component.array.length-1):(r.leftBound=a-r.config.numElements+1,r.rightBound=a),i(a*n,b)}},r.pageRight=function(){r.leftBound=r.leftBound+r.config.numElements<=r.component.array.length-r.config.numElements?r.leftBound+r.config.numElements:r.component.array.length-r.config.numElements,r.rightBound=r.rightBound+r.config.numElements<=r.component.array.length-1?r.rightBound+r.config.numElements:r.component.array.length-1,f(!0)},r.pageLeft=function(){r.leftBound=r.leftBound-r.config.numElements>=0?r.leftBound-r.config.numElements:0,r.rightBound=r.rightBound-r.config.numElements>=r.config.numElements-1?r.rightBound-r.config.numElements:r.config.numElements-1,f(!1)},r.right=function(){r.leftBound=r.leftBound+1<=r.component.array.length-r.config.numElements?r.leftBound+1:r.component.array.length-r.config.numElements,r.rightBound=r.rightBound+1<=r.component.array.length-1?r.rightBound+1:r.component.array.length-1,g(!0)},r.left=function(){r.leftBound=r.leftBound-1>=0?r.leftBound-1:0,r.rightBound=r.rightBound-1>=r.config.numElements-1?r.rightBound-1:r.config.numElements-1,g(!1)},r}),S.component("tree",function(a){function b(a){return{value:a,left:null,right:null,sid:S.nextId()}}function c(a,d){if(!a)return null;var e=b(a.value);return e.parent=d,e.left=c(a.left,e),e.right=c(a.right,e),e}function d(a){return a?a.height=1+Math.max(d(a.left),d(a.right)):-1}function e(a){if(a){var b=!0;return a.left&&(b=a.left.value<=a.value),a.right&&b&&(b=a.right.value>=a.value),b&&e(a.left)&&e(a.right)}return!0}var f=new S.Component,g=0;return f.alias="tree",f.live={},f.init=function(){f.tree=c(a,null),f.state=a,g=d(f.tree),d(f.tree)},f.height=function(){return g},f.computeHeights=function(){d(f.tree)},f.live.root=function(){return f.tree?f.tree:void 0},f.live.height=function(){return g},f.live.add=function(a,c,e){var g;return g=c?a.right=b(e):a.left=b(e),d(f.tree),g},f.live.clear=function(){f.tree=b("__")},f.live.remove=function(a){a.parent&&a.parent.left==a?(console.info("Setting parent.left to null"),a.parent.left=null):a.parent&&a.parent.right==a?(console.info("Setting parent.right to null"),a.parent.right=null):console.info("node.parent doesn't exist."),f.computeHeights()},f.live.mark=null,f.live.markPath=null,f.live.clearPath=null,f.live.showHeights=null,f.live.hideHeights=null,f.live.height=null,f.live.clearlabels=null,f.live.clearfocus=null,f.live.travel=null,f.live.label=null,f.live.focusOn=null,f.live.setNode=function(a,b){a.value=b},f.live.isBinary=function(){return e(f.tree)},f.getMethods=function(){return S.getComponentMethods("tree")},f.noCopy=!0,f}),S.view("tree",function(){function a(a,b,c){return circle=m.circle(b+o,c+p+2,u).addClass("tree-node")}function b(a,b){return m.text(r(a).x+o+u+5,r(a).y+p+u/2-3,"/"+b).addClass("tree-node-label").attr("text-anchor","right").attr("font-size",u)}function c(a,b,c){return m.text(b+o,c+p+.5*u,a+"").addClass("tree-node-value").attr("text-anchor","middle").attr("font-size",1.25*u)}function d(a,b,c,d){return m.line(a+o,b+p,c+o,d+p).addClass("tree-line")}function e(a){return m.text(r(a).x+o-u-.85*u,r(a).y+p+u/2-3,a.height+"").attr("font-size",u).addClass("tree-height")}function f(){}function g(a){a.left&&(r(a).leftLine=d(r(a).x,r(a).y,r(a.left).x,r(a.left).y),g(a.left)),a.right&&(r(a).rightLine=d(r(a).x,r(a).y,r(a.right).x,r(a.right).y),g(a.right))}function h(a,b){a&&(b(a),h(a.left,b),h(a.right,b))}function i(a){var b=[];return a?(console.log("element is "+r(a).element),b.push(r(a).element),b.push(r(a).s_height),b.push(r(a).s_value),b.push(r(a).s_label),b.push(r(a).leftLine),b.push(r(a).rightLine),console.log("returning "+b.concat(i(a.left).concat(i(a.right)))),b.concat(i(a.left).concat(i(a.right)))):b}function j(a,b,c){function d(a){this.value=a.value,this.left=null,this.right=null,this.x=0,this.y=0,this.thread=!1,this.offset=0,this.sid=a.sid}function e(a){this.node=a,this.offset=0,this.level=0}function f(a){var b;return a?(b=new d(a),b.left=f(a.left),b.right=f(a.right)):b=null,b}function g(a,b,c,d){var f,h,i,k,l,m,n=new e(null),o=new e(null),p=new e(null),q=new e(null);if(!a)return d.level=-1,void(c.level=-1);if(a.y=b*j.mv,f=a.left,h=a.right,g(f,b+1,n,o),g(h,b+1,p,q),null===f&&null===h)d&&c&&(c.node=a,d.node=a,c.level=b,d.level=b,c.offset=0,d.offset=0),a.offset=0;else{for(i=j.mh,k=j.mh,l=0,m=0;null!==f&&null!==h;)i<j.mh&&(k+=j.mh-i,i=j.mh),null!==f.right?(l+=f.offset,i-=f.offset,f=f.right):(l-=f.offset,i+=f.offset,f=f.left),null!==h.left?(m-=h.offset,i-=h.offset,h=h.left):(m+=h.offset,i+=h.offset,h=h.right);a.offset=(k+1)/2,l-=a.offset,m+=a.offset,q.level>o.level||null==a.left?(d=q,d.offset+=a.offset):(d=o,d.offset-=a.offset),null!=f&&f!=a.left&&p.node?(p.node.thread=!0,p.node.offset=Math.abs(p.offset+a.offset-l),l-a.offset<=p.offset?p.node.left=f:p.node.right=f):null!=h&&h!=a.right&&o.node&&(o.node.thread=!0,o.node.offset=Math.abs(o.offset-a.offset-m),m+a.offset>=o.offset?o.node.right=h:o.node.left=h)}}function h(a,b,c){null!=a&&(a.x=b,a.thread&&(a.thread=!1,a.right=null,a.left=null),h(a.left,b-a.offset,c),h(a.right,b+a.offset,c))}function i(a,b){a&&(b(a)[j.xProperty]=a.x,b(a)[j.yProperty]=a.y,i(a.left,b),i(a.right,b))}var j={mh:10,mv:10,xProperty:"x",yProperty:"y"};$.extend(j,c);var k=f(a);g(k,0,null,null),h(k,0,!1),i(k,b)}var k,l,m,n,o,p,q=new S.View,r=S.map(),s=100,t=100,u=8,v=32,w=32;return q.init=function(){},q.scaleTo=function(a){s=a.width,t=a.height,o=s/2,u=q.config.nodeRadius||.05*t,p=u,w=q.config.mv||t/5,v=q.config.mh||w+u/2,q.$element.width(s),q.$element.height(t),q.render()},q.render=function(){return k&&k.remove(),k=$('<div class="tree"></div>'),l=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=$(l).width(s).height(t).appendTo(k),m=Snap(l),m.addClass("tree-svg"),j(q.component.tree,r,{mh:v,mv:w,x0:o,y0:p}),g(q.component.tree),h(q.component.tree,function(b){r(b).element=a(b,r(b).x,r(b).y),r(b).s_value=c(b.value,r(b).x,r(b).y),r(b).s_height=e(b),f(b)}),q.$element.append(k),q.$element},q.live.focusOn=function(a,b){if(a){{r(a).element.addClass("focus")}b()}},q.live.clearfocus=function(a){r.forEach(function(a){a[1].element.removeClass("focus")}),a()},q.live.add=function(a,b,c,d){b?r(a.right).doNotDraw=!0:r(a.left).doNotDraw=!0,q.scaleTo({width:s,height:t}),q.render(),d()},q.live.travel=function(a,b,c){if(b)if(r(a).rightLine){var d=r(a).rightLine;d.addClass("tree-line-active");var e=m.circle(d.attr("x1"),d.attr("y1"),5).addClass("tree-travelorb");e.insertAfter(d),e.animate({cx:d.attr("x2"),cy:d.attr("y2")},500,null,function(){e.remove(),c()})}else c();else if(r(a).leftLine){var f=r(a).leftLine;f.addClass("tree-line-active");var e=m.circle(f.attr("x1"),f.attr("y1"),5).addClass("tree-travelorb");e.insertAfter(f),e.animate({cx:f.attr("x2"),cy:f.attr("y2")},500,null,function(){e.remove(),c()})}else c()},q.live.label=function(a,c,d){a&&r(a)?(r(a).label=c,r(a).s_label=b(a,c),d()):d()},q.live.setNode=function(a,b,c){var d=r(a).element,e=r(a).s_value;S.wait(function(){d.addClass("tree-remove"),e.addClass("tree-remove"),S.wait(function(){d.removeClass("tree-remove"),e.removeClass("tree-remove").attr("text",b),c()},300)},200)},q.live.clear=function(a){q.render(),a()},q.live.clearlabels=function(a){r.forEach(function(a){q.live.clearlabel(a[0])}),a()},q.live.clearlabel=function(a,b){r(a).s_label&&(r(a).s_label.remove(),r(a).label=void 0,r(a).s_label=void 0),b&&b()},q.live.showHeights=function(a){r.forEach(function(a){q.live.height(a[0],!0)}),a()},q.live.hideHeights=function(a){r.forEach(function(a){q.live.height(a[0],!1)}),a()},q.live.height=function(a,b,c){a&&r(a).s_height&&(console.log("s_height = "+r(a).s_height),b?r(a).s_height.attr("visibility","visible"):r(a).s_height.attr("visibility","hidden"),c&&c())},q.live.remove=function(a,b){function c(){console.log("allremoved, count max "+g+" "+d),g>=d&&(console.log("all removed!"),e.forEach(function(a){a&&a.remove()}),q.render(),b())}var d,e=i(a),f=a.parent,g=0;e.push(null==f.left?r(f).leftLine:r(f).rightLine),d=e.length,e.forEach(function(a){return a?void(a.attr("cy")?a.animate({cy:1e3},500,mina.easeinout,function(){g++,c()}):a.attr("y1")?a.animate({y1:1e3,y2:1e3},500,mina.easeinout,function(){g++,c()}):a.animate({y:1e3},500,mina.easeinout,function(){g++,c()})):void g++})},q.live.mark=function(a,b,c){r(a).element&&(r(a).element.addClass("range"+b),c())},q.live.markPath=function(a,b,c,d){b&&r(a).rightLine?r(a).rightLine.addClass("pathrange"+c):r(a).leftLine&&r(a).leftLine.addClass("pathrange"+c),d()},q.live.clearPath=function(a,b,c,d){b&&r(a).rightLine?r(a).rightLine.removeClass("pathrange"+c):r(a).leftLine&&r(a).leftLine.removeClass("pathrange"+c),d()},q.add=function(){},q}),function(){function a(a,b){S.Component.call(this,a,b)}function b(a){return a}function d(a){return a?a.height=1+Math.max(d(a.left),d(a.right)):-1}function e(a){return{value:a,left:null,right:null,sid:S.nextId()}}function f(a,b){if(!a)return null;var c=e(a.value);return c.parent=b,c.left=f(a.left||e._left,c),c.right=f(a.right||e._right,c),c}a.prototype=Object.create(S.Component.prototype),a.prototype.live={},Object.defineProperty(a.prototype,"state",{get:function(){return this._state},set:function(a){this._state=f(a,null),this.height=d(this._state)}}),a.prototype.live.root=function(){return this.state},a.prototype.live.root.getter=!0,a.prototype.live.height=function(){return this.height=d(),this.height},a.prototype.live.height.getter=!0,a.prototype.live.add=function(a,f,g){var h;return h=f?a.right=e(g):a.left=e(g),this.height=d(c.tree),b(h)},a.prototype.live.remove=function(a){a.parent&&a.parent.left==a?a.parent.left=null:a.parent&&a.parent.right==a&&(a.parent.right=null),this.height=d(this.state)},a.prototype.live.setNode=function(a,b){a.value=b},a.prototype.live.setChild=function(){},a.prototype.live.mark=null,a.prototype.live.markPath=null,a.prototype.live.clearPath=null,a.prototype.live.showHeights=null,a.prototype.live.hideHeights=null,a.prototype.live.height=null,a.prototype.live.clearlabels=null,a.prototype.live.clearfocus=null,a.prototype.live.travel=null,a.prototype.live.label=null,a.prototype.live.focusOn=null,S.defineComponent2("tree2",a)}(),S.view("tree2",function(){function a(a,b,c){return circle=m.circle(b+o,c+p+2,u).addClass("tree-node")}function b(a,b){return m.text(r(a).x+o+u+5,r(a).y+p+u/2-3,"/"+b).addClass("tree-node-label").attr("text-anchor","right").attr("font-size",u)}function c(a,b,c){return m.text(b+o,c+p+.5*u,a+"").addClass("tree-node-value").attr("text-anchor","middle").attr("font-size",1.25*u)}function d(a,b,c,d){return m.line(a+o,b+p,c+o,d+p).addClass("tree-line")}function e(a){return m.text(r(a).x+o-u-.85*u,r(a).y+p+u/2-3,a.height+"").attr("font-size",u).addClass("tree-height")}function f(){}function g(a){a.left&&(r(a).leftLine=d(r(a).x,r(a).y,r(a.left).x,r(a.left).y),g(a.left)),a.right&&(r(a).rightLine=d(r(a).x,r(a).y,r(a.right).x,r(a.right).y),g(a.right))}function h(a,b){a&&(b(a),h(a.left,b),h(a.right,b))}function i(a){var b=[];return a?(b.push(r(a).element),b.push(r(a).s_height),b.push(r(a).s_value),b.push(r(a).s_label),b.push(r(a).leftLine),b.push(r(a).rightLine),b.concat(i(a.left).concat(i(a.right)))):b}function j(a,b,c){function d(a){this.value=a.value,this.left=null,this.right=null,this.x=0,this.y=0,this.thread=!1,this.offset=0,this.sid=a.sid}function e(a){this.node=a,this.offset=0,this.level=0}function f(a){var b;return a?(b=new d(a),b.left=f(a.left),b.right=f(a.right)):b=null,b}function g(a,b,c,d){var f,h,i,k,l,m,n=new e(null),o=new e(null),p=new e(null),q=new e(null);if(!a)return d.level=-1,void(c.level=-1);if(a.y=b*j.mv,f=a.left,h=a.right,g(f,b+1,n,o),g(h,b+1,p,q),null===f&&null===h)d&&c&&(c.node=a,d.node=a,c.level=b,d.level=b,c.offset=0,d.offset=0),a.offset=0;else{for(i=j.mh,k=j.mh,l=0,m=0;null!==f&&null!==h;)i<j.mh&&(k+=j.mh-i,i=j.mh),null!==f.right?(l+=f.offset,i-=f.offset,f=f.right):(l-=f.offset,i+=f.offset,f=f.left),null!==h.left?(m-=h.offset,i-=h.offset,h=h.left):(m+=h.offset,i+=h.offset,h=h.right);a.offset=(k+1)/2,l-=a.offset,m+=a.offset,q.level>o.level||null==a.left?(d=q,d.offset+=a.offset):(d=o,d.offset-=a.offset),null!=f&&f!=a.left&&p.node?(p.node.thread=!0,p.node.offset=Math.abs(p.offset+a.offset-l),l-a.offset<=p.offset?p.node.left=f:p.node.right=f):null!=h&&h!=a.right&&o.node&&(o.node.thread=!0,o.node.offset=Math.abs(o.offset-a.offset-m),m+a.offset>=o.offset?o.node.right=h:o.node.left=h)}}function h(a,b,c){null!=a&&(a.x=b,a.thread&&(a.thread=!1,a.right=null,a.left=null),h(a.left,b-a.offset,c),h(a.right,b+a.offset,c))}function i(a,b){a&&(b(a)[j.xProperty]=a.x,b(a)[j.yProperty]=a.y,i(a.left,b),i(a.right,b))}var j={mh:10,mv:10,xProperty:"x",yProperty:"y"};$.extend(j,c);var k=f(a);g(k,0,null,null),h(k,0,!1),i(k,b)}var k,l,m,n,o,p,q=new S.View,r=S.map(),s=100,t=100,u=8,v=32,w=32;return q.init=function(){},q.scaleTo=function(a){s=a.width,t=a.height,o=s/2,u=q.config.nodeRadius||.05*t,p=u,w=q.config.mv||t/5,v=q.config.mh||w+u/2,q.$element.width(s),q.$element.height(t),q.render()},q.render=function(){return k&&k.remove(),k=$('<div class="tree"></div>'),l=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=$(l).width(s).height(t).appendTo(k),m=Snap(l),m.addClass("tree-svg"),j(q.component.state,r,{mh:v,mv:w,x0:o,y0:p}),g(q.component.state),h(q.component.state,function(b){r(b).element=a(b,r(b).x,r(b).y),r(b).s_value=c(b.value,r(b).x,r(b).y),r(b).s_height=e(b),f(b)}),q.$element.append(k),q.$element},q.live.focusOn=function(a,b){if(a){{r(a).element.addClass("focus")}b()}},q.live.clearfocus=function(a){r.forEach(function(a){a[1].element.removeClass("focus")}),a()},q.live.add=function(a,b,c,d){b?r(a.right).doNotDraw=!0:r(a.left).doNotDraw=!0,q.scaleTo({width:s,height:t}),q.render(),d()},q.live.travel=function(a,b,c){if(b)if(r(a).rightLine){var d=r(a).rightLine;d.addClass("tree-line-active");var e=m.circle(d.attr("x1"),d.attr("y1"),5).addClass("tree-travelorb");e.insertAfter(d),e.animate({cx:d.attr("x2"),cy:d.attr("y2")},500,null,function(){e.remove(),c()})}else c();else if(r(a).leftLine){var f=r(a).leftLine;f.addClass("tree-line-active");var e=m.circle(f.attr("x1"),f.attr("y1"),5).addClass("tree-travelorb");e.insertAfter(f),e.animate({cx:f.attr("x2"),cy:f.attr("y2")},500,null,function(){e.remove(),c()})}else c()},q.live.label=function(a,c,d){a&&r(a)?(r(a).label=c,r(a).s_label=b(a,c),d()):d()},q.live.setNode=function(a,b,c){var d=r(a).element,e=r(a).s_value;S.wait(function(){d.addClass("tree-remove"),e.addClass("tree-remove"),S.wait(function(){d.removeClass("tree-remove"),e.removeClass("tree-remove").attr("text",b),c()},300)},200)},q.live.clear=function(a){q.render(),a()},q.live.clearlabels=function(a){r.forEach(function(a){q.live.clearlabel(a[0])}),a()},q.live.clearlabel=function(a,b){r(a).s_label&&(r(a).s_label.remove(),r(a).label=void 0,r(a).s_label=void 0),b&&b()},q.live.showHeights=function(a){r.forEach(function(a){q.live.height(a[0],!0)}),a()},q.live.hideHeights=function(a){r.forEach(function(a){q.live.height(a[0],!1)}),a()},q.live.height=function(a,b,c){a&&r(a).s_height&&(b?r(a).s_height.attr("visibility","visible"):r(a).s_height.attr("visibility","hidden"),c&&c())},q.live.remove=function(a,b){function c(){g>=d&&(console.log("all removed!"),e.forEach(function(a){a&&a.remove()}),q.render(),b())}var d,e=i(a),f=a.parent,g=0;e.push(null==f.left?r(f).leftLine:r(f).rightLine),d=e.length,e.forEach(function(a){return a?void(a.attr("cy")?a.animate({cy:1e3},500,mina.easeinout,function(){g++,c()}):a.attr("y1")?a.animate({y1:1e3,y2:1e3},500,mina.easeinout,function(){g++,c()}):a.animate({y:1e3},500,mina.easeinout,function(){g++,c()})):void g++})},q.live.mark=function(a,b,c){r(a).element&&(r(a).element.addClass("range"+b),c())},q.live.markPath=function(a,b,c,d){b&&r(a).rightLine?r(a).rightLine.addClass("pathrange"+c):r(a).leftLine&&r(a).leftLine.addClass("pathrange"+c),d()},q.live.clearPath=function(a,b,c,d){b&&r(a).rightLine?r(a).rightLine.removeClass("pathrange"+c):r(a).leftLine&&r(a).leftLine.removeClass("pathrange"+c),d()},q.add=function(){},q}),S.method("array","finish",function(){this.clearfocus(),this.leftTo(0)}),S.method("array","swap",function(a,b){this.log("swapping"),this("temp",this.getItem(a)),this.setItem(a,this.getItem(b)),this.setItem(b,this("temp"))}),S.method("array","isSorted",function(){for(var a=1;a<this.getLength();a++)if(this.getItem(a)<this.getItem(a-1))return!1;return!0}),S.method("array","searchLinear",function(a){for(var b=0;b<this.getLength();b++)if(this.focus(b),this.getItem(b)==a)return void this.flag(b);this.finish()}),S.method("array","searchBinary",function(a){function b(c,d){if(c>d)return this.clearrange(1),void this.finish();this.clearrange(1),this.range(c,d,1);var e=Math.floor((c+d)/2);if(this.focus(e),a<this.getItem(e))b.call(this,c,e-1);else{if(!(a>this.getItem(e)))return this.focus(e),void this.flag(e);b.call(this,e+1,d)}}this.isSorted()||this.warn("Array is not sorted. Binary search will not behave correctly."),b.call(this,0,this.getLength())}),console.log("creating insertionSort"),S.method("array","insertionSort",function(){for(var a=0;a<this.getLength();a++){for(this("j",a);this("j")>0&&this.getItem(this("j")-1)>this.getItem(this("j"));)this.swap(this("j"),this("j")-1),this("swapped",!0),this("j",this("j")-1);this.range(0,a,1)}this.clearrange(1),this.finish()}),S.method("array","bubbleSort",function(){for(this("swap",!0);this.is("swap",!0);){this("swap",!1);for(var a=0;a<this.getLength()-1;a++)this.focus(a),this.getItem(a)>this.getItem(a+1)&&(this.range(a,a+1,2),this.swap(a,a+1),this("swap",!0),this.clearrange(2))}this.finish()}),S.method("array","quickSort",function(){}),S.method("tree","finish",function(){this.clearfocus()}),S.method("tree","buildBST",function(){this.clear(),this.setNode(this.root(),12),this("left",this.add(this.root(),!1,6)),this("right",this.add(this.root(),!0,13)),this.add(this("left"),!1,4),this.add(this("right"),!0,14)}),S.method("tree","isBST",function(){}),S.method("tree","traversal",function(a){function b(a){a&&(e.call(this,a),this.travel(a,!1),b.call(this,a.left),this.travel(a,!0),b.call(this,a.right))}function c(a){a&&(this.travel(a,!1),c.call(this,a.left),e.call(this,a),this.travel(a,!0),c.call(this,a.right))}function d(a){a&&(this.travel(a,!1),d.call(this,a.left),this.travel(a,!0),d.call(this,a.right),e.call(this,a))}function e(a){this.focusOn(a),f.call(this,a)}function f(a){this.label(a,g),g++}var g=0;a&&(a=a.trim().toLowerCase()),"pre"===a||"preorder"===a?b.call(this,this.root()):"in"===a||"inorder"===a?c.call(this,this.root()):"post"===a||"postorder"===a?d.call(this,this.root()):c.call(this,this.root()),this.finish()});